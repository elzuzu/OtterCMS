import{j as s}from"./vendor-ui-CtvHukzg.js";import{r as e}from"./vendor-data-BY55b65u.js";import{D as a}from"./DattaPageTitle-T82UHXFU.js";import{C as i}from"./MainContent-CulcTigp.js";import{D as l}from"./main-BtLJocfP.js";import{D as r}from"./DattaCard-Ca8oAgyz.js";import"./vendor-react-DjGYZWH8.js";import"./WindowControls-nBMnr5hL.js";function c({message:e}){return s.jsxs("div",{className:"text-center py-5",children:[s.jsx("div",{className:"avtar avtar-xl bg-light-primary mb-4",children:s.jsx("i",{className:"ph-duotone ph-folder-notch-open f-36"})}),s.jsx("h5",{className:"mb-3",children:e})]})}function d({user:d,onNavigateToMyIndividus:n,onNavigateToAllIndividus:t}){const[m,o]=e.useState(null),[h,x]=e.useState(!0),[v,j]=e.useState(null),u=e.useCallback((async()=>{if(x(!0),j(null),!d||!d.id&&!d.userId)return j("Utilisateur invalide. Impossible de charger les statistiques."),void x(!1);const s={userId:d.id||d.userId,role:d.role};try{const e=await window.api.getDashboardStats(s);e&&e.success&&e.data?o(e.data):(j((null==e?void 0:e.error)||"Erreur lors du chargement des statistiques."),o(null))}catch(e){j(`Erreur de communication avec le serveur: ${e.message}`),o(null)}finally{x(!1)}}),[d]);return e.useEffect((()=>{u()}),[u]),h?s.jsxs("div",{className:"pc-content",children:[s.jsx(a,{title:"Tableau de bord"}),s.jsx(r,{children:s.jsx("div",{style:{textAlign:"center",marginTop:"2rem"},children:s.jsx(i,{})})})]}):v?s.jsxs("div",{className:"pc-content",children:[s.jsx(a,{title:"Tableau de bord"}),s.jsx(r,{children:s.jsx("div",{children:s.jsxs("div",{className:"error-message",style:{margin:"var(--spacing-4) 0"},children:[v,s.jsx(l,{variant:"secondary",onClick:u,style:{marginLeft:"var(--spacing-3)"},children:"Réessayer"})]})})})]}):s.jsxs("div",{className:"pc-content",children:[s.jsx(a,{title:"Tableau de bord"}),m?s.jsx(r,{children:s.jsx("div",{children:s.jsxs("div",{className:"row",children:[void 0!==m.mesIndividus&&s.jsx("div",{className:"col-lg-3 col-md-6 col-sm-12 mb-4",children:s.jsx("div",{className:"card h-100 card-hover shadow-hover",onClick:n,role:"button",tabIndex:0,onKeyDown:s=>"Enter"===s.key&&n(),style:{cursor:"pointer"},children:s.jsx("div",{className:"card-body",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"avtar avtar-s bg-light-success",children:s.jsx("i",{className:"feather icon-user-check"})})}),s.jsxs("div",{className:"flex-grow-1 ms-3",children:[s.jsxs("h6",{className:"mb-0",children:["Dossiers en charge",s.jsx("i",{className:"feather icon-external-link ms-2 text-muted",style:{fontSize:"0.8rem"}})]}),s.jsx("p",{className:"mb-0 text-muted",children:m.mesIndividus}),m.totalIndividus>0&&s.jsxs("small",{className:"text-success",children:[(m.mesIndividus/m.totalIndividus*100).toFixed(0),"% du total"]})]})]})})})}),void 0!==m.totalIndividus&&s.jsx("div",{className:"col-lg-3 col-md-6 col-sm-12 mb-4",children:s.jsx("div",{className:"card h-100 card-hover shadow-hover",onClick:t,role:"button",tabIndex:0,onKeyDown:s=>"Enter"===s.key&&t(),style:{cursor:"pointer"},children:s.jsx("div",{className:"card-body",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"avtar avtar-s bg-light-primary",children:s.jsx("i",{className:"feather icon-users"})})}),s.jsxs("div",{className:"flex-grow-1 ms-3",children:[s.jsxs("h6",{className:"mb-0",children:["Total Individus",s.jsx("i",{className:"feather icon-external-link ms-2 text-muted",style:{fontSize:"0.8rem"}})]}),s.jsx("p",{className:"mb-0 text-muted",children:m.totalIndividus})]})]})})})}),("admin"===d.role||"manager"===d.role)&&void 0!==m.individusNonAttribues&&s.jsx("div",{className:"col-lg-3 col-md-6 col-sm-12 mb-4",children:s.jsx("div",{className:"card h-100",children:s.jsx("div",{className:"card-body",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"avtar avtar-s bg-light-warning",children:s.jsx("i",{className:"feather icon-user-x"})})}),s.jsxs("div",{className:"flex-grow-1 ms-3",children:[s.jsx("h6",{className:"mb-0",children:"Individus non attribués"}),s.jsx("p",{className:"mb-0 text-muted",children:m.individusNonAttribues}),s.jsx("div",{className:"mt-2",children:m.individusNonAttribues>0?s.jsxs("div",{className:"badge bg-light-warning text-warning",children:[s.jsx("i",{className:"feather icon-alert-triangle"})," ",m.individusNonAttribues]}):s.jsxs("div",{className:"badge bg-light-success text-success",children:[s.jsx("i",{className:"feather icon-check"})," Tous attribués"]})})]})]})})})}),s.jsx("div",{className:"col-lg-3 col-md-6 col-sm-12 mb-4",children:s.jsx("div",{className:"card bg-light-info h-100",children:s.jsx("div",{className:"card-body",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"avtar avtar-s bg-info",children:s.jsx("i",{className:"feather icon-user"})})}),s.jsxs("div",{className:"flex-grow-1 ms-3",children:[s.jsx("h6",{className:"mb-0",children:"Connecté en tant que"}),s.jsx("p",{className:"mb-0",children:s.jsx("strong",{children:d.username})}),s.jsx("span",{className:"badge bg-info",children:d.role})]})]})})})}),("admin"===d.role||"manager"===d.role)&&s.jsxs("div",{className:"row mt-4",children:[void 0!==m.totalUsers&&s.jsx("div",{className:"col-lg-4 col-md-6 col-sm-12 mb-4",children:s.jsx("div",{className:"card h-100",children:s.jsx("div",{className:"card-body",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"avtar avtar-s bg-light-secondary",children:s.jsx("i",{className:"feather icon-folder"})})}),s.jsxs("div",{className:"flex-grow-1 ms-3",children:[s.jsx("h6",{className:"mb-0",children:"Total Utilisateurs"}),s.jsx("p",{className:"mb-0 text-muted",children:m.totalUsers})]})]})})})}),"admin"===d.role&&void 0!==m.categoriesMasquees&&m.categoriesMasquees>0&&s.jsx("div",{className:"col-lg-4 col-md-6 col-sm-12 mb-4",children:s.jsx("div",{className:"card h-100",children:s.jsx("div",{className:"card-body",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"avtar avtar-s bg-light-danger",children:s.jsx("i",{className:"feather icon-folder"})})}),s.jsxs("div",{className:"flex-grow-1 ms-3",children:[s.jsx("h6",{className:"mb-0",children:"Catégories masquées"}),s.jsx("p",{className:"mb-0 text-muted",children:m.categoriesMasquees})]})]})})})})]})]})})}):s.jsx(r,{children:s.jsxs("div",{className:"text-center",children:[s.jsx(c,{message:"Aucune statistique disponible pour le moment."}),s.jsx(l,{variant:"primary",onClick:u,style:{marginTop:"var(--spacing-3)"},children:"Recharger"})]})})]})}export{d as default};
